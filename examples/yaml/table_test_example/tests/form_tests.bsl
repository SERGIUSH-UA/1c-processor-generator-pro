// Тести для форми "Форма" - Form Module style (v2.23.2+)
//
// ВАЖЛИВО:
// - Використовуйте Объект.РеквізитІмя для доступу до реквізитів обробки
// - Додавайте &НаСервере до всіх процедур (Form Module context)
// - Команди викликайте через ІмяКоманди(Неопределено)
// - Всі процедури повинні бути Экспорт
//
// СТИЛЬ КОДУ:
// ✅ Объект.Число1 (з префіксом Объект.)
// ✅ &НаСервере (обов'язкова директива)
// ✅ Процедура ТестІмя() Экспорт
// ❌ Прямий доступ до реквізитів (це для ObjectModule тестів)

#Область Тести_Арифметики

&НаСервере
Процедура Тест_Сложение() Экспорт
    // Тест: 5 + 3 = 8

    // Встановлюємо значення
    Объект.Число1 = 5;
    Объект.Число2 = 3;

    // Викликаємо команду форми
    Сложить(Неопределено);

    // Перевіряємо результат
    Если Объект.Результат <> 8 Тогда
        ВызватьИсключение СтрШаблон(
            "Помилка: 5 + 3 повинно дорівнювати 8, отримано %1",
            Формат(Объект.Результат, "ЧГ=0")
        );
    КонецЕсли;

    Сообщить("✓ Тест пройдено: 5 + 3 = 8");
КонецПроцедуры

&НаСервере
Процедура Тест_ОтрицательныеЧисла() Экспорт
    // Тест: -10 + 5 = -5 (перевірка роботи з від'ємними числами)

    Объект.Число1 = -10;
    Объект.Число2 = 5;
    Сложить(Неопределено);

    Если Объект.Результат <> -5 Тогда
        ВызватьИсключение СтрШаблон(
            "Помилка: -10 + 5 повинно дорівнювати -5, отримано %1",
            Формат(Объект.Результат, "ЧГ=0")
        );
    КонецЕсли;

    Сообщить("✓ Тест пройдено: -10 + 5 = -5");
КонецПроцедуры

&НаСервере
Процедура Тест_БольшиеЧисла() Экспорт
    // Тест: 1000000 + 2000000 = 3000000 (перевірка роботи з великими числами)

    Объект.Число1 = 1000000;
    Объект.Число2 = 2000000;
    Сложить(Неопределено);

    Если Объект.Результат <> 3000000 Тогда
        ВызватьИсключение СтрШаблон(
            "Помилка: 1000000 + 2000000 повинно дорівнювати 3000000, отримано %1",
            Формат(Объект.Результат, "ЧГ=0")
        );
    КонецЕсли;

    Сообщить("✓ Тест пройдено: 1000000 + 2000000 = 3000000");
КонецПроцедуры

&НаСервере
Процедура Тест_Ноль() Экспорт
    // Тест: 10 + 0 = 10 (перевірка додавання нуля)

    Объект.Число1 = 10;
    Объект.Число2 = 0;
    Сложить(Неопределено);

    Если Объект.Результат <> 10 Тогда
        ВызватьИсключение СтрШаблон(
            "Помилка: 10 + 0 повинно дорівнювати 10, отримано %1",
            Формат(Объект.Результат, "ЧГ=0")
        );
    КонецЕсли;

    Сообщить("✓ Тест пройдено: 10 + 0 = 10");
КонецПроцедуры

#КонецОбласті

#Область Тести_УправлінняСтаном

&НаСервере
Процедура Тест_Очистка() Экспорт
    // Тест: кнопка Очистить обнуляє всі поля

    // Встановлюємо значення
    Объект.Число1 = 100;
    Объект.Число2 = 200;
    Объект.Результат = 300;

    // Очищаємо через команду форми
    Очистить(Неопределено);

    // Перевіряємо що всі поля обнулені
    Если Объект.Число1 <> 0 Тогда
        ВызватьИсключение СтрШаблон(
            "Помилка: Число1 повинно бути 0, отримано %1",
            Формат(Объект.Число1, "ЧГ=0")
        );
    КонецЕсли;

    Если Объект.Число2 <> 0 Тогда
        ВызватьИсключение СтрШаблон(
            "Помилка: Число2 повинно бути 0, отримано %1",
            Формат(Объект.Число2, "ЧГ=0")
        );
    КонецЕсли;

    Если Объект.Результат <> 0 Тогда
        ВызватьИсключение СтрШаблон(
            "Помилка: Результат повинен бути 0, отримано %1",
            Формат(Объект.Результат, "ЧГ=0")
        );
    КонецЕсли;

    Сообщить("✓ Тест пройдено: всі поля успішно обнулені");
КонецПроцедуры

#КонецОбласті

// ПРИМІТКИ ПО МІГРАЦІЇ З ObjectModule ТЕСТІВ:
//
// ObjectModule style (External Connection - швидко, без UI):
// Процедура Тест() Экспорт
//     Число1 = 5;  // ← БЕЗ Объект.
//     Сложить();   // ← БЕЗ параметра Команда
// КонецПроцедуры
//
// Form Module style (Automation Server - повільно, з UI):
// &НаСервере
// Процедура Тест() Экспорт
//     Объект.Число1 = 5;     // ← З Объект.
//     Сложить(Неопределено); // ← З параметром Команда
// КонецПроцедуры
