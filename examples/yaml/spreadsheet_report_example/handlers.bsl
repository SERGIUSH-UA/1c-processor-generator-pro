//======================================================================
// Обробники подій форми
//======================================================================

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	// Ініціалізація форми
	Объект.Период = ТекущаяДата();
КонецПроцедуры

//======================================================================
// Обробники команд
//======================================================================

&НаКлиенте
Процедура Сформувати(Команда)
	СформуватиНаСервере();
КонецПроцедуры

&НаСервере
Процедура СформуватиНаСервере()
	// Очищуємо попередній звіт
	Отчет.Очистить();

	// Створюємо табличний документ
	ТабДок = Новый ТабличныйДокумент;

	// Шапка звіту
	Область = ТабДок.Область(1, 1, 1, 3);
	Область.Текст = "Звіт за період: " + Формат(Объект.Период, "ДФ='dd.MM.yyyy'");
	Область.Шрифт = Новый Шрифт(, 14, Истина);
	Область.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Центр;

	// Заголовки колонок
	ТабДок.Область(3, 1).Текст = "№";
	ТабДок.Область(3, 2).Текст = "Найменування";
	ТабДок.Область(3, 3).Текст = "Сума";

	// Виділяємо заголовки
	ОбластьЗаголовки = ТабДок.Область(3, 1, 3, 3);
	ОбластьЗаголовки.Шрифт = Новый Шрифт(, , Истина);
	ОбластьЗаголовки.ЦветФона = WebЦвета.СветлоСерый;

	// Дані (приклад)
	Для Індекс = 1 По 10 Цикл
		Рядок = 3 + Індекс;
		ТабДок.Область(Рядок, 1).Текст = Формат(Індекс, "ЧГ=0");
		ТабДок.Область(Рядок, 2).Текст = "Елемент " + Формат(Індекс, "ЧГ=0");
		ТабДок.Область(Рядок, 3).Текст = Формат(Індекс * 100, "ЧДЦ=2; ЧН=0,00");

		// Додаємо розшифровку для drill-down
		Расшифровка = "Детали_" + Формат(Індекс, "ЧГ=0");
		ТабДок.Область(Рядок, 1, Рядок, 3).Расшифровка = Расшифровка;
	КонецЦикла;

	// Підсумок
	РядокПідсумок = 14;
	ТабДок.Область(РядокПідсумок, 2).Текст = "Всього:";
	ТабДок.Область(РядокПідсумок, 3).Текст = Формат(5500, "ЧДЦ=2; ЧН=0,00");
	ОбластьПідсумок = ТабДок.Область(РядокПідсумок, 1, РядокПідсумок, 3);
	ОбластьПідсумок.Шрифт = Новый Шрифт(, , Истина);

	// Встановлюємо ширину колонок
	ТабДок.Область(, 1, , 1).ШиринаКолонки = 5;
	ТабДок.Область(, 2, , 2).ШиринаКолонки = 30;
	ТабДок.Область(, 3, , 3).ШиринаКолонки = 15;

	Отчет = ТабДок;
КонецПроцедуры

//======================================================================
// Обробники подій елементів
//======================================================================

&НаКлиенте
Процедура ОтчетПолеОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;

	Если ТипЗнч(Расшифровка) = Тип("Строка") Тогда
		Сообщить("Клік по елементу з розшифровкою: " + Расшифровка);
		// Тут можна відкрити деталі, форму об'єкта тощо
	КонецЕсли;
КонецПроцедуры
