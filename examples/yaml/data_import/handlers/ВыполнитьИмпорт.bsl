// Client-side validation before import
// Перевірка перед імпортом

// Validate catalog name
Если НЕ ЗначениеЗаполнено(Объект.Справочник) Тогда
	Сообщить("Укажите целевой справочник!");
	Возврат;
КонецЕсли;

// Validate preview data
Если Предпросмотр.Количество() = 0 Тогда
	Сообщить("Нет данных для импорта!");
	Возврат;
КонецЕсли;

// Confirm import
Ответ = Вопрос(
	"Импортировать " + Предпросмотр.Количество() + " записей в справочник '" + Объект.Справочник + "'?",
	РежимДиалогаВопрос.ДаНет
);

Если Ответ = КодВозвратаДиалога.Нет Тогда
	Возврат;
КонецЕсли;

// Perform import on server
Попытка
	ВыполнитьИмпортНаСервере();

	// Navigate to Step 4 (Results)
	Элементы.ШагиМастера.ТекущаяСтраница = Элементы.Шаг4Результаты;

	Сообщить("Импорт завершен!");
Исключение
	Сообщить("Ошибка импорта: " + ОписаниеОшибки());
КонецПопытки;
