// Client-side validation before loading preview
// Перевірка перед завантаженням попереднього перегляду

// Validate file path
Если НЕ ЗначениеЗаполнено(Объект.ПутьКФайлу) Тогда
	Сообщить("Выберите файл для импорта!");
	Возврат;
КонецЕсли;

// Check file exists (client-side check)
Файл = Новый Файл(Объект.ПутьКФайлу);
Если НЕ Файл.Существует() Тогда
	Сообщить("Файл не найден: " + Объект.ПутьКФайлу);
	Возврат;
КонецЕсли;

// Validate encoding
Если НЕ ЗначениеЗаполнено(Объект.Кодировка) Тогда
	Сообщить("Укажите кодировку файла!");
	Возврат;
КонецЕсли;

// Load preview on server
Попытка
	ЗагрузитьПредпросмотрНаСервере();

	// Navigate to Step 2
	Элементы.ШагиМастера.ТекущаяСтраница = Элементы.Шаг2Предпросмотр;

	Сообщить("Загружено строк: " + Предпросмотр.Количество());
Исключение
	Сообщить("Ошибка загрузки файла: " + ОписаниеОшибки());
КонецПопытки;
